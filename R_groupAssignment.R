library(dplyr)
library(readr)
library(stringr)

vehicle <- read.csv("https://raw.githubusercontent.com/sit-2021-int214/010-CheapestElectricCars/main/Cheapestelectriccars-EVDatabase.csv");
View(vehicle)

#Data Clean
vehicle <- distinct(vehicle)
vehicle$Acceleration<-vehicle$Acceleration %>% str_remove("sec") %>% str_trim() %>% as.numeric() 
vehicle$TopSpeed<-vehicle$TopSpeed %>% str_remove("km/h") %>% str_trim() %>% as.numeric()
vehicle$Range<-vehicle$Range %>% str_remove("km") %>% str_trim() %>%as.numeric()
vehicle$Efficiency<-vehicle$Efficiency %>% str_remove("Wh/km") %>% str_replace("-","0") %>% str_trim() %>% as.numeric()
vehicle$FastChargeSpeed<-vehicle$FastChargeSpeed %>% str_remove("km/h") %>% str_trim() %>% as.numeric()
vehicle$NumberofSeats<-vehicle$NumberofSeats %>% as.numeric()
vehicle$PriceinGermany<-vehicle$PriceinGermany %>% str_remove("â,¬") %>% str_remove(",") %>% as.numeric()
vehicle$PriceinUK<-vehicle$PriceinUK %>% str_remove("Â£") %>% str_remove(",") %>% as.numeric()

vehicle <- vehicle %>% rename(`Acceleration(sec)` = Acceleration)
vehicle <- vehicle %>% rename(`TopSpeed(km/h)` = TopSpeed)
vehicle <- vehicle %>% rename(`Range(km)` = Range)
vehicle <- vehicle %>% rename(`Efficiency(Wh/km)` = Efficiency)
vehicle <- vehicle %>% rename(`FastChargeSpeed(km/h)` = FastChargeSpeed)
vehicle <- vehicle %>% rename(`PriceinGermany(â,¬)` = PriceinGermany)
vehicle <- vehicle%>% rename(`PriceinUK(Â£)` = PriceinUK)

#1. ????????????????????????????????????????????????????????????????????????????????????????????????????????? select name ????????????
#- highest top speed
vehicle %>% select(Name,`TopSpeed(km/h)`)%>% filter(`TopSpeed(km/h)` == max(`TopSpeed(km/h)`))
#- highest range
vehicle %>% select(Name,`Range(km)`)%>%filter(`Range(km)` == max(`Range(km)`))
#- highest efficiency
vehicle %>% select(Name,`Efficiency(Wh/km)`)%>%filter(`Efficiency(Wh/km)` == max(`Efficiency(Wh/km)`))
#- highest FastChargeSpeed
vehicle %>% select(Name,`FastChargeSpeed(km/h)`)%>%filter(`FastChargeSpeed(km/h)` == max(`FastChargeSpeed(km/h)`,na.rm = T))
#- lowest Acceleration
vehicle %>%select(Name,`Acceleration(sec)`)%>% filter(`Acceleration(sec)` == max(`Acceleration(sec)`))
#2.??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????(20/10/21 uk = 46.17 ????????? ,eu = 38.75 ?????????)
vehicle %>% select(Name,`PriceinUK(Â£)`)%>%filter(`PriceinUK(Â£)`*46.17 == max(`PriceinUK(Â£)`*46.17,na.rm = T))
#3.???????????????????????????????????????????????????????????????  4 ????????????????????? ???????????????????????????????????????????????????????????????????????????
vehicle %>%select(Name,NumberofSeats,`PriceinUK(Â£)`) %>%filter(NumberofSeats == 4 & `PriceinUK(Â£)` < mean(`PriceinUK(Â£)`,na.rm = T))
#4.?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
vehicle %>% filter(NumberofSeats == max(NumberofSeats)) %>% count() - vehicle %>% filter(NumberofSeats == min(NumberofSeats)) %>% count()
#5.???????????????????????????????????????????????????????????????????????????????????? ???????????????????????????????????????????????????????????? 150 km/h
vehicle %>%filter(Drive == "Front Wheel Drive" & `TopSpeed(km/h)` > 150) %>% select(Name)
#6. acceralation ????????? topspeed ??????????????????????????? Tesla ??????????????????????????????????????????????????????????????????
vehicle %>% filter(str_detect(Name,"Tesla") & (`TopSpeed(km/h)` == max(`TopSpeed(km/h)`) & `Acceleration(sec)` == min(`Acceleration(sec)`)))%>%select(`TopSpeed(km/h)`,`Acceleration(sec)`)
#7.????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
frontvehicle <- vehicle%>%filter(Drive == "Front Wheel Drive")
allvehicle <- vehicle %>% filter(Drive == "All Wheel Drive")
rearvehicle <- vehicle %>% filter(Drive == "Rear Wheel Drive")
vehicle %>% filter(Drive == "Front Wheel Drive" &`PriceinUK(Â£)` == min(frontvehicle$`PriceinUK(Â£)`,na.rm = T))
vehicle %>% filter(Drive == "All Wheel Drive" & `PriceinUK(Â£)` == min(allvehicle$`PriceinUK(Â£)`,na.rm = T))
vehicle %>% filter(Drive == "Rear Wheel Drive" & `PriceinUK(Â£)` == min(rearvehicle$`PriceinUK(Â£)`,na.rm = T))
#8.??????????????????????????????????????????????????????n????????????????????????????????? ??????????????????????????????????????????????????????????????????????????????????????????????????????
vehicle %>% filter(`Efficiency(Wh/km)` == max(`Efficiency(Wh/km)`))
#9.????????????????????????????????????????????????????????????????????????????????????????????????
vehicle %>% summarise(mean(`Efficiency(Wh/km)`))
#10.?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
vehicle %>% filter(`Acceleration(sec)` <= mean(`Acceleration(sec)`)&`TopSpeed(km/h)` >= mean(`TopSpeed(km/h)`)& `Range(km)` >= mean(`Range(km)`)&`Efficiency(Wh/km)`>= mean(`Efficiency(Wh/km)`)&`FastChargeSpeed(km/h)` >= mean(`FastChargeSpeed(km/h)`,na.rm =T)&NumberofSeats >= mean(NumberofSeats)&`PriceinUK(Â£)` <= mean(`PriceinUK(Â£)`))
